from datetime import timedelta

from django.utils import timezone
from django.utils.dateparse import parse_datetime
from drf_spectacular.types import OpenApiTypes
from drf_spectacular.utils import OpenApiParameter, extend_schema, extend_schema_view
from rest_framework import status, viewsets
from rest_framework.decorators import action
from rest_framework.exceptions import PermissionDenied, ValidationError
from rest_framework.permissions import IsAuthenticated
from rest_framework.response import Response

from reservations.models import Reservation
from reservations.permissions import IsAdminRole, IsOwnerOrAdmin
from reservations.serializers import (
    ReservationAdminSerializer,
    ReservationCreateSerializer,
    ReservationDecisionSerializer,
    ReservationPublicSerializer,
    ReservationUpdateSerializer,
)
from reservations.services import (
    approve_reservation,
    busy_blocks,
    cancel_reservation,
    create_reservation,
    reject_reservation,
    update_reservation,
)
